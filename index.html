<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Word of the Day</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="icon" type="image/x-icon" href="images/favicon.ico">
  <link rel="manifest" href="manifest.json" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-title" content="Word of The Day" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <link rel="apple-touch-icon" href="images/favicon.ico" />
  <link rel="stylesheet" href="styles.css">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
</head>
<body>
  <!-- Dark Mode Toggle -->
  <button id="darkModeToggle" class="toggle-btn">
    <svg class="dark-svg" width="auto" height="35px" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M1.66077 11.3619C2.09296 11.4524 2.54093 11.5 3.00002 11.5C6.58987 11.5 9.50002 8.58987 9.50002 5.00002C9.50002 3.25482 8.81224 1.67027 7.69295 0.502625C11.4697 0.604839 14.5 3.69855 14.5 7.50002C14.5 11.366 11.366 14.5 7.49999 14.5C5.06138 14.5 2.91401 13.253 1.66077 11.3619Z" stroke="currentColor" stroke-linejoin="round"/>
    </svg>
  </button>

  

  <!-- Date -->
  <div class="date">
    <span class="date-flex">
      <svg class="date-svg" xmlns="http://www.w3.org/2000/svg" width="1.5rem" height="1.5rem" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z"/>
        <path d="M20 3v4"/><path d="M22 5h-4"/><path d="M4 17v2"/><path d="M5 18H3"/>
      </svg>
      <span id="date"></span>
    </span>
  </div>

  <!-- Title -->
  <header>
    <h1 class="todayTitle">Today's Word</h1>
    <h2 class="todayPhrase">Expand your vocabulary</h2>
  </header>

  <!-- Word Card -->
  <section class="word-card">
    <h3 class="word" id="word">Loading...</h3>
    <p class="definition" id="definition">Fetching definition...</p>
    <button id="saveFavorite" class="save-btn">Save to Favorites</button>
  </section>

  <!-- Example Card -->
  <section class="example-card">
    <h4>Example:</h4>
    <p class="example" id="example">Loading example...</p>
  </section>

  <!-- Favorites List -->
  <section class="favorites-card">
    <h4>Favorites</h4>
    <ul id="favoritesList"></ul>
  </section>

  <script>
  // Show today's date
  const options = { weekday: 'long', month: 'long', day: 'numeric' };
  document.getElementById('date').textContent = new Date().toLocaleDateString(undefined, options);

  // Dark mode toggle
  const darkToggle = document.getElementById("darkModeToggle");
  darkToggle.addEventListener("click", () => {
    document.body.classList.toggle("dark");
    localStorage.setItem("darkMode", document.body.classList.contains("dark"));
  });

  if (localStorage.getItem("darkMode") === "true") {
    document.body.classList.add("dark");
  }

  // Favorites system
  let favorites = JSON.parse(localStorage.getItem("favorites")) || [];
  const favoritesList = document.getElementById("favoritesList");

  function renderFavorites() {
    favoritesList.innerHTML = "";
    favorites.forEach((word, index) => {
      const li = document.createElement("li");
      li.textContent = word;

      // Delete button
      const delBtn = document.createElement("button");
      delBtn.textContent = "❌";
      delBtn.classList.add("delete-btn");
      delBtn.addEventListener("click", () => {
        if (confirm(`Remove "${word}" from favorites?`)) {
          favorites.splice(index, 1);
          localStorage.setItem("favorites", JSON.stringify(favorites));
          renderFavorites();
        }
      });

      li.appendChild(delBtn);
      favoritesList.appendChild(li);
    });
  }

  function saveWord(word) {
    if (!favorites.includes(word)) {
      favorites.push(word);
      localStorage.setItem("favorites", JSON.stringify(favorites));
      renderFavorites();
    }
  }

  // Fetch word data
  fetch("/api/proxy")
    .then(response => response.json())
    .then(data => {
      let word = data.word[0].toUpperCase() + data.word.slice(1);
      document.getElementById('word').textContent = word || 'No word found.';
      document.getElementById('definition').textContent = data.definition || 'No definition found.';
      document.getElementById('example').textContent = data.example || 'No example available.';
      
      document.getElementById("saveFavorite").addEventListener("click", () => saveWord(word));
    })
    .catch(err => {
      console.error(err);
      document.getElementById('word').textContent = 'Error loading word.';
    });

  // Render saved favorites on load
  renderFavorites();
</script>

</body>
</html>
